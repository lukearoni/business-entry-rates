---
title: "New Businesses in Different Areas"
subtitle: "Comparing Establishment Entry Rates in Different Metropolitan Areas"
author: Luke Li
execute:
    echo: false
    message: false
    warning: false
---
## Plot

```{r}
library(tidyverse)
library(tidycensus)
library(janitor)
```

```{r}
bds2022 <- read_csv("bds2022_msa.csv") %>%
  clean_names() %>%
  filter(year == 2022) %>%
  select(
    msa,
    estabs_entry,        
    estabs_exit,  
    estabs_entry_rate,  # startup rate
    estabs_exit_rate,   # business exit rate
    firms, estabs, emp
  ) %>%
  drop_na()
```

```{r}
# Load crosswalk file
msa_names <- read_csv("list1_2020.csv") %>%
  clean_names() %>%
  transmute(
    cbsa_code = as.character(cbsa_code),
    msa_name = cbsa_title
  )

# Clean your BDS data and convert code to character
bds2022 <- bds2022 %>%
  mutate(msa = as.character(msa)) %>%
  left_join(msa_names, by = c("msa" = "cbsa_code")) %>%
  select(msa_name, everything())
```

```{r}
#| eval: false
#| echo: false
bds2022 |>
  distinct() |> 
ggplot(aes(x = estabs_entry_rate, y = estabs_exit_rate, label = msa_name)) +
  geom_point(color = "#1f78b4", alpha = 0.7, size = 3) +
  ggrepel::geom_text_repel(data = subset(bds2022, estabs_entry_rate > 20)) +
  labs(
    title = "Do Metro Areas With More Startups See Lower Exit Rates?",
    subtitle = "BDS 2022: Establishment Entry vs. Exit Rates by MSA",
    x = "Startup Rate (Establishment Entries per 100 Existing)",
    y = "Exit Rate (Establishment Exits per 100 Existing)",
    caption = "Source: U.S. Census Bureau BDS 2022"
  ) +
  theme_minimal()
```

```{r}
bds_rates <- bds2022 %>%
  mutate(
    startup_rate_raw = estabs_entry_rate,
    exit_rate_raw = estabs_exit_rate
  )
```

```{r, fig.width=16, fig.height=8}
bds2022 |>
  distinct() |> 
  slice_max(order_by = estabs_entry_rate, n = 20) |>
  mutate(rank = row_number()) |>
  ggplot(aes(x = factor(rank, levels = rev(1:20)), y = estabs_entry_rate)) +
  coord_flip() + 
  geom_col(fill = "#1f78b4") +
  geom_text(aes(label = paste0(msa_name, ": ", round(estabs_entry_rate, 1))), 
          vjust = 0.5, hjust = -0.1, size = 4) +
scale_y_continuous(limits = c(0, 28)) +
labs(
    title = "Top 20 Metro Areas by Establishment Entry Rate (2022)",
    subtitle = "Share of new establishments out of total existing establishments",
    x = "Rank",
    y = "Entry Rate (%)",
    caption = "Source: U.S. Census Bureau BDS 2022"
  ) +
  theme_minimal() + 
  theme(
    plot.title = element_text(size = 24, face = "bold"),
    plot.subtitle = element_text(size = 20),
    axis.title = element_text(size = 20),
    plot.caption = element_text(size = 20)
  )
```

**Description:** Establishment entry rates vary amongst different metropolitan areas. We obtained a dataset containing business dynamics data from the US Census Bureau, including the 2022 establishment entry and exit rates for each metropolitan area. This records the number of new shops, startups, or franchise buildings divided by the total number of establishments in that area during 2022. We seek to use this data to find the metropolitan areas with the highest rate. Sheridan, Wyoming is a high outlier for establishment entry rates, with an over 6% increase from the second highest, while the rest of the top 20 metropolitan area entry rates don't differ by more than 2.2%.
